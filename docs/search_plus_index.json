{"./":{"url":"./","title":"Tutorial","keywords":"","body":"Tutorial for EasyMultiProfiler package (v1.0) =4.0-brightgreen.svg\" referrerpolicy=\"no-referrer\">   Bingdong Liu✉️, erqiang Hu, Yaxi Liu and Liwei Xie✉️ 2024-07 The EasyMultiProfiler package aims to offer a user-friendly and efficient multi-omics data analysis tool on the R platform. It facilitates various essential tasks related to microbiome, genome, and metabolite downstream analysis, providing a seamless workflow from start to finish. Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-08 00:00:18 "},"MD/1 EasyMultiProfiler初识.html":{"url":"MD/1 EasyMultiProfiler初识.html","title":"Chapter 1 Basic information","keywords":"","body":"1 EasyMultiProfiler EasyMultiProfiler包采用了面向对象的编程方法，集合了多个数据分析模块。数据可以在不同模块之间流畅地传递，使得分析流程标准化和清晰化。 1.1 EasyMultiProfiler的安装 1.1.1 首次安装 Mac os 用户： if (!requireNamespace(\"pak\", quietly=TRUE)) install.packages(\"pak\") pak::pak(\"liubingdong/EasyMultiProfiler\") library(EasyMultiProfiler) Windows用户： 需要根据自己的R版本安装对应的RTool。例如R 4.3.x 需要安装 RTool4.3，R 4.4.x 需要安装 RTool4.4。 RTool（约400MB）下载安装地址： 官方原始地址 中国镜像地址 (在页面中依此点击[Download R for Windows] ->[Rtools]) 安装对应版本的RTool，请重启R后，使用pak包进行安装if (!requireNamespace(\"pak\", quietly=TRUE)) install.packages(\"pak\") pak::pak(\"liubingdong/EasyMultiProfiler\") library(EasyMultiProfiler) 1.1.2 更新版本 EasyMultiProfiler包在持续更新更多的分析和可视化模块，当需要更新版本时，可以再次运行pak即可进行更新。 pak::pak(\"liubingdong/EasyMultiProfiler\") library(EasyMultiProfiler) 1.2 EasyMultiProfiler基本知识 1.2.1 EasyMultiProfiler的数据对象容器 MAE对象：即MultiAssayExperiment。MAE对象是用户需要初始创建的对象，通常是由多个组学项目的实验数据和与之对应的行数据、列数据组成（也支持创建单一组学项目的MAE对象）。 EMPT对象：即EMP-transporter。从MAE对象中提取出单一组学项目，即形成EMPT对象。在EMPT对象中，实验数据、行数据和列数据之间的关系不会因为“提取”操作而改变。 EMP对象：当多个EMPT对象进行联合分析时，可以将这些EMPT对象合并成一个EMP对象。在EMP对象中，每个EMPT对象内实验数据、行数据和列数据之间的关系不会因为“合并”操作而改变。 注意：为了尽可能保证原始数据不会被篡改，数据分析过程中从MAE→EMPT的过程是单向的，即不能将EMPT对象重新放回MAE对象，但是当进行联合分析时，EMPT对象可以直接使用+符号组合成EMP对象继续进行组学联合流程。 1.2.2 EasyMultiProfiler的数据展现格式 EasyMultiProfiler包采用tibble格式（一种数据框类型）来呈现数据，在tibble的列名下，用户可以查看对应列的数据类型。常见的数据类型包括：int-整数型、dbl-浮点型、chr-字符串型、lgl-逻辑型(True和False)、fct-因子型、date-日期型、dttm-日期时间型。 1.2.3 EasyMultiProfiler的数据传递 EasyMultiProfiler包使用|>操作符以帮助数据传递，即将前一个函数的输出作为后一个函数的输入，从而实现连续的数据处理操作（与Magrittr包的%>%操作符功能相同）。 1.2.4 EasyMultiProfiler的函数行动参数 EasyMultiProfiler包进行数据分析操作时，组学数据将会存储在EMPT对象容器内进行功能模块之间的传递。当用户需要在某个模块完成后，可以使用action参数进行提取该模块产生的原始分析结果。此参数默认值为action='add'意味着当前功能模块的分析结果将会添加到EMPT对象内进行传递，当action='get'意味着当前功能模块的分析结果将直接输出。 特殊情况：在EMP_filter函数中的action用于指定此模块操作时剔除(kick)或者保留(select)。 Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-08 01:20:48 "},"MD/2 创建MAE对象.html":{"url":"MD/2 创建MAE对象.html","title":"Chapter 2 Import data","keywords":"","body":"2 创建MultiAssayExperiment对象 本章节主要介绍如何将多组学数据导入分析流程的数据容器。 2.1 创建多组学项目的MultiAssayExperiment对象 当用户处理多个组学数据时，需要将数据导入并组合成一个MAE对象。 2.1.1 创建样本与受试者关系表 由于各个组学数据中样本的名称和实际采样名称（受试者名称）不一致。因此，我们需要建立组学数据内样本名称和实际采样名称（受试者名称）的关系表，以便将全部数据导入MultiAssayExperiment对象内。这样在后续的分析中，EasyMultiProfiler可以自动将各个组学数据自动替换成实际采样名称（受试者名称）。 关系表中的列名称必须为assay,primary,colname。其中assay为组学的名称，用户可以自定修改定义。primary为实际采样名称（受试者名称），需与表型数据中的名称一致。colname为各个组学中实际样本样本的名称。 此表需要保存为文件，读入R中。教程里可以命名为dfmap。用户也可以手动在R内通过数据框直接创建。 dfmap 2.1.2 读取表型数据注意事项： 表型数据一般指样本的基本信息，如受试者的个人信息、量表结果、检查数据等。如果部分结果中存在缺失值，请直接留空，不要用NA，-，missing等字符展位，影响后续的连贯操作。数据的第一列请设置为样本的名称，在读取时将其设置为行名（重要）。 ## row.names=1 必须将样本名作为行名 meta_data 2.1.3 读取微生物组学数据 微生物数据一般指各种微生物上游注释工具产出的包含各个样本内微生物丰度信息的结果文件。常见的结果文件，一般分为ASV/OTU表格，门纲目科属种级别丰度表，MetaPhlan和Humann产生的带有层级关系的丰度表，BIOM格式文件和QIIME2专属的QZV文件。EMP_taxonomy_import支持以上全部格式结果输入，将其转化为SummmariseExperiment对象文件。 2.1.3.1 读取ASV/OTU表格 此文件内第一行和第二行的“#”字符无需修改。数据文件内必须要包含taxonomy的物种注释信息。 tax_data 2.1.3.2 读取门纲目科属种级别丰度表 由于高分类级别数据可以计算出低分类级别数据，因此建议用户直接使用最高分类级别的数据导入。 tax_data 2.1.3.3 MetaPhlan和Humann的分类注释表 此注释表的物种注释包含层级结构，一般包含了界门纲目科属种各级别全部结果信息。EMP_taxonomy_import可以自动识别最高分类级别注释信息，并导入完整分类数据。注意需要将humann_format=TRUE。 tax_data 2.1.3.4 BIOM格式文件 BIOM格式是QIIME1流程中常见的物种注释结果文件，部分用户也会将QIIME2流程的物种注释文件保存为BIOM格式便于数据存储。EMP_taxonomy_import可以直接读取biom格式文件，并导入数据信息。注意file_format='biom' tax_data 2.1.3.5 BIOM格式文件转化后的表格文件 BIOM文件可以利用biom convert方法转换成表格文件，也可以直接导入。无需修改表头和#符号。 tax_data 2.1.3.6 qzv格式文件 在Qiime2流程qiime taxa barplot会产生微生物注释结果qzv文件。EMP_taxonomy_import可以直接读取这个qzv格式文件，并导入数据信息。注意file_format='qzv' tax_data 2.1.4 读取KO/EC组学数据 2.1.4.1 普通表格形式 本数据主要指宏基因组或者宏转录组学注释的以KO或者EC编号注释的结果文件。EMP_function_import可以直接读取注释表格，并查询KEGG数据库整合对应的注释信息。注意编码中必须是纯KO和EC编号。 ko_data 2.1.4.1 Humann格式 本数据是由Humann工具产生的分层KO/EC注释表。EMP_function_import会忽略掉UNGROUPED的信息，直接读取注释表格，并查询KEGG数据库整合对应的注释信息。注意文件的表头需要清理干净，删除#等字符。 ko_data 2.1.5 读取标准表格信息 本数据一般用于转录组数据或者代谢组数据等特征无须特殊格式的数据导入 2.1.5.1 不含特征信息的数据导入 本数据一般常见于转录组或者基因组数据，行为基因，列为样本。 tran_data 2.1.5.2 包含特征信息的数据导入 本数据一般常见于代谢组学数据，行为基因，列为样本和特征的注释。导入这种数据时，需要指定数据内样本的内容。 # 直接指定样本名称 idx 2.1.6 整合全部数据导入MultiAssayExperiment对象 注意：1. 这里的dfmap就是 2.1.1中的关系表。2. objlist内命名必须与关系表中的组学名称assay保持一致。 #### 关系表的assay要转换为因子 dfmap$assay 2.2 创建单一组学项目的MultiAssayExperiment对象 有时用户只有单一的组学数据比如微生物组学数据或者转录组学数据，可以使用EMP_easy_import快速构建MultiAssayExperiment对象，直接进行下游分析流程。注意：1. type参数包含tax,ko,ec和normal四种方式，需要用户根据上文判断使用。2. 在此模式中，丰度矩阵的样本名称必须与表型数据中的样本名称一致。 ## row.names=1 必须将样本名作为行名 meta_data Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-08 01:28:10 "},"MD/3 EasyMultiProfiler内置示例MAE对象.html":{"url":"MD/3 EasyMultiProfiler内置示例MAE对象.html","title":"Chapter 3 Demo data","keywords":"","body":"3. EasyMultiProfiler内置示例数据 EasyMultiProfiler 内置了示例MAE对象，其包含五个组学项目的数据：taxonomy（16s rRNA基因测序的物种注释）、geno_ko（ko基因注释）、geno_ec（ec酶注释）、untarget_metabol（非靶向代谢组学数据）、host_gene（宿主基因数据）。 载入MAE对象 data(MAE) 组学项目的概览 EasyMultiProfiler 提供了快捷数据概览模块，便于用户从三个维度快速查看MAE对象容器内存储的数据情况。Data dimention显示每个组学内包含的样本和特征的数目，以及组学内数据数据格式（如FPKM、relative、TPM等，由用户在导入时指定）。Data information显示组学内样本相关信息的数目（比如受试者的基本信息种类数目）和组学内特信息的种类数目（如微生物数据的界门纲目科属种株）。Data miss显示组学内数据的缺失情况。 EMP |> EMP_summary() Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-08 01:28:50 "},"MD/4 数据提取 Data Extract.html":{"url":"MD/4 数据提取 Data Extract.html","title":"Chapter 4 Data Extract :","keywords":"","body":"4. 数据提取 Data Extract EasyMultiProfiler 内存储的每个组学数据包含三个基本内容，分别为assay（实验数据）、coldata（列数据”） 、rowdata（行数据）。assay的“列”\"样本名称\"，“行“为\"特征\"；coldata的”列“为“样本名称”（与assay的“列”对应），”行“为“样本的相关数据”；rowdata的”列“为”特征“（与assay的“行”对应），”行“为”特征的相关信息“。 实验数据 (assay) 列数据 (coldata) 行数据 (rowdata) 列（column） 样本名称 样本名称 特征 行（row） 特征 样本的相关数据 特征的相关信息 Data Extract 包含包含三个函数EMP_assay_extract、EMP_coldta_extract和EMP_rowdata_extract帮助用户从MAE对象中提取指定的组学数据及其相关信息，以供后续的下游分析。以微生物组学数据为示例： 4.1 提取组学丰度数据 assay MAE |> EMP_assay_extract(experiment='taxonomy') EMP_assay_extract内部提供了检索参数，帮助快速发现感兴趣特征的丰度矩阵。 示例1： 查找微生物数据中的乳杆菌属下的菌种。 MAE |> EMP_assay_extract(experiment='taxonomy', pattern = 'Lactobacillus',pattern_ref = 'Genus') 示例2： 例如查找基因组KO注释数据中的puua和puuc相关丰度矩阵。注意：这里的pattern_ref对应的是rowdata内的信息。 MAE |> EMP_assay_extract(experiment='geno_ko', pattern = c('puua','puuc'),pattern_ref = 'Name') 4.2 提取组学特征数据 rowdata 注意：当EMP_rowdata_extract内指定了组学名称时，输出的是该组学特征的相关信息，例如微生物组学则输出特征的门纲目科属种株的分级注释或者功能基因KO注释则输出对应KO基因在KEGG数据库检索的相关信息。如果未指定experiment参数则输出的是整个MAE对象中全部组学特征的相关信息。 示例1： 显示微生物特征的分级注释情况。 MAE |> EMP_rowdata_extract(experiment='taxonomy') 示例2： 显示KO注释表在KEGG数据库中的注释信息 MAE |> EMP_rowdata_extract(experiment='geno_ko') 示例3： 显示查找特定基因的注释情况 MAE |> EMP_assay_extract(experiment='geno_ko', pattern = 'puua',pattern_ref = 'Name')|> EMP_rowdata_extract() 4.3 提取组学表型数据 coldata 注意：当EMP_coldata_extract内指定了组学名称时，输出的是该组学样本的表型数据信息。如果未指定experiment参数则输出的是整个MAE对象中全部队列样本的表型数据信息。 MAE |> EMP_coldata_extract(experiment='taxonomy') Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-08 00:39:31 "},"MD/5 数据预处理 Data Preparetion.html":{"url":"MD/5 数据预处理 Data Preparetion.html","title":"Chapter 5 Data Preparation :","keywords":"","body":"数据预处理 Data Preparation : 欢迎阅读本章教程，本教程旨在为您提供在EasyMultiProfiler数据分析流程中进行各种主流数据的预处理步骤。包括标准化、批次校正、过滤分析、特征转换和特征折叠等 Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-08 00:40:57 "},"MD/5.1 数据折叠 EMP_collapse.html":{"url":"MD/5.1 数据折叠 EMP_collapse.html","title":"5.1 EMP_collapse","keywords":"","body":"5.1 数据折叠 EMP_collapse 数据折叠是指对数据的原有特征进行聚合以生成新的assay。EMP_collapse可以按照rowdata或者coldata中的数据进行合并，合并过程中被合并的数据可以选择计算平均值、中位数、求和、最大值和最小值。 5.1.1 根据重复的coldata数据合并组学项目的实验数据 EMP_collapse 可以将组学项目的实验数据按照coldata中的信息进行折叠。例如，参数experiment指定组学项目为taxonomy，参数collapse_by指定按照col（列数据）折叠，参数estimate_group指定按照coldata的Group列折叠，参数method参数指定折叠方法为mean（取平均值），参数collapse_sep指定使用+分隔符来合并该实验数据的列数据中发生折叠的字符串单元格。 k1 EMP_collapse(experiment = 'untarget_metabol',collapse_by='col', estimate_group = 'Group',method = 'mean',collapse_sep = '+') |> EMP_assay_extract(action = 'get') k2 EMP_collapse(experiment = 'untarget_metabol',collapse_by='col', estimate_group = 'Group',method = 'mean',collapse_sep = '+') |> EMP_coldata_extract(action = 'get') k3 EMP_collapse(experiment = 'untarget_metabol',collapse_by='col', estimate_group = 'Group',method = 'mean',collapse_sep = '+') |> EMP_rowdata_extract() 原始数据信息： MAE |> EMP_assay_extract(experiment='taxonomy') 折叠后assay信息： MAE |> EMP_assay_extract(experiment='taxonomy') |> EMP_collapse(collapse_by='col',estimate_group = 'Group', method = 'mean',collapse_sep = '+') 折叠后coldata信息： 注意：当发生数据折叠后，coldata信息也进行的折叠。如果coldata中的数据属于数值变量，则和assay使用一样的方法进行计算，如果数据属于字符串变量，则使用collapse_sep制定的符号进行合并。 MAE |> EMP_assay_extract(experiment='taxonomy') |> EMP_collapse(collapse_by='col',estimate_group = 'Group', method = 'mean',collapse_sep = '+') |> EMP_coldata_extract() 5.1.2 根据重复的rowdata数据合并组学项目的实验数据 ​ EMP_collapse 也可以将组学项目的实验数据按照rowdata中的信息进行折叠。 在微生物组学中，一般输入MAE对象内的微生物数据为最高分类精度的数据如种或者株级别。EMP_collapse可以按照rowdata内的分类级别，快速合成低分类精度的数据如科级别或者属级别。 MAE |> EMP_assay_extract(experiment='taxonomy') |> EMP_collapse(collapse_by='row',estimate_group = 'Class', method = 'sum',collapse_sep = '+') 在代谢组学数据中，我们也可以快速按照代谢物的注释级别进行数据合并。注意：合并的特征需要在rowdata信息中。可以使用EMP_rowdata_extract查看可合并的信息。 原始数据信息： MAE |> EMP_assay_extract(experiment = 'untarget_metabol') 按照kegg二级代谢产物折叠后的数据 注意：在一些原始数据中经常出现NA, null, - 等符号占位表示缺失值，使用na_string参数可以指定这些占位缺失值的字符串，在合并过程中如果指定的合并特征中出现缺失值，则该行数据将会被忽略。 MAE |> EMP_assay_extract(experiment = 'untarget_metabol') |> EMP_collapse(estimate_group = 'MS2kegg',collapse_by='row', na_string = c(\"NA\", \"null\", \"\",\"-\"), method = 'mean',collapse_sep = '+') Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 17:21:16 "},"MD/5.2 批次校正 EMP_adjust_abudance.html":{"url":"MD/5.2 批次校正 EMP_adjust_abudance.html","title":"5.2 EMP_adjust_abudance","keywords":"","body":"5.2 批次校正 EMP_adjust_abudance 批次效应（batch effect）是实验或研究中经常遇到的一种现象，是指在数据采集过程中由于各种因素导致的系统性变异，而与研究变量无关。批次效应通常由以下原因导致：实验的不同部分在不同时间完成、实验条件的变化（包括：仪器、试剂批次、试剂用量、测序批次等）、数据来源不同（例如：将自己的数据集与公共数据集整合分析）等。批次效应的存在可能对数据分析和结果解释产生影响，而平常的标准化方法不足以调整批次之间的差异。EMP_adjust_abudance模块可帮助用户有效地解决批次效应的校正问题，其包含了三种最常用的校正方法：combat_seq、combat和limma_remove_batch_effect。这些方法均可以通过缩小批次效应来提高数据的可比性和可靠性。 5.2.1 combat方法 该模块引用了sva包的 comBat 算法用于校正批次效应。comBat使用参数或非参数经验贝叶斯模型来校正批次效应，输入的数据为已经清洗、标准化的表达数据，返回的是一个已针对批次效应进行校正的表达矩阵。 使用函数EMP_assay_extract提取组学项目geno_ko的实验数据。使用函数EMP_adjust_abudance对已提取的实验数据进行校正，参数.factor_unwanted指定不感兴趣的因素是'Region'，后续将对其进行校正；参数.factor_of_interest指定感兴趣的因素是'Group'；参数method指定使用'combat'方法进行批次效应校正。 MAE |> EMP_assay_extract(experiment='geno_ko') |> EMP_adjust_abundance(.factor_unwanted = 'Region',.factor_of_interest = 'Group', method = 'combat') 5.2.2 combat_seq方法 该模块引用了sva包的 comBat_seq 函数用于校正批次效应。comBat_seq 是 combat的改进模型，使用负二项式回归，专门针对 RNA-Seq 计数数据。 MAE |> EMP_assay_extract(experiment='geno_ko') |> EMP_adjust_abundance(.factor_unwanted = 'Region',.factor_of_interest = 'Group', method = 'combat_seq') 5.2.3 limma_remove_batch_effect方法 该模块引用了limma 包的 removeBatchEffect 函数用于校正批次效应。该函数通常用于微阵列数据或RNA测序数据批次效应的去除。 MAE |> EMP_assay_extract(experiment='geno_ko') |> EMP_adjust_abundance(.factor_unwanted = 'Region',.factor_of_interest = 'Group', method = 'limma_remove_batch_effect') Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 16:55:09 "},"MD/5.3 实验数据的特征转换 EMP_feature_convert.html":{"url":"MD/5.3 实验数据的特征转换 EMP_feature_convert.html","title":"5.3 EMP_feature_convert","keywords":"","body":"5.3 实验数据的特征转换 EMP_feature_convert 在组学研究中，基因的命名方式因所使用的数据库不同而不固定。因此，在进行转录组学富集分析时，需要将基因名称转换为其对应的唯一编号（通常称ENTREZID）。而在代谢组学分析中，同样存在着多个数据库之间的编号转换问题。EMP_feature_convert提供了基因ID和代谢物ID在多个数据库之间的便捷转换。 5.3.1 用于基因ID的转换 转换前： MAE |> EMP_assay_extract(experiment='host_gene') 转换后： 注意：EasyMultiProfiler内置了Human,Mouse,Pig,Zebrafish四个常用物种的参考基因集。如果数据为其他物种，可以使用OrgDb参数制定对应的参考数据集（https://bioconductor.org/packages/release/BiocViews.html#___OrgDb） MAE |> EMP_assay_extract(experiment='host_gene') |> EMP_feature_convert(from = 'SYMBOL',to = 'ENTREZID',species = 'Human') 5.3.2 用于代谢物ID的转换 转换前 MAE |> EMP_assay_extract(experiment = 'untarget_metabol')|> EMP_collapse(na_string=c('NA','null','','-'), estimate_group = 'MS2kegg',method = 'sum',collapse_by = 'row') 转换后 将代谢产物从KEGG的Compound注释，转换为Human Metabolome Database的ID注释 MAE |> EMP_assay_extract(experiment = 'untarget_metabol'), EMP_collapse(na_string=c('NA','null','','-'), estimate_group = 'MS2kegg',method = 'sum',collapse_by = 'row') |> EMP_feature_convert(from = 'KEGG',to='HMDB') Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 16:55:34 "},"MD/5.4 数据标准化 EMP_decostand.html":{"url":"MD/5.4 数据标准化 EMP_decostand.html","title":"5.4 EMP_decostand","keywords":"","body":"5.4 数据标准化 EMP_decostand 多组学数据分析中，不同数据的量纲、量级不同。为了消除这些差异导致分析结果的偏倚，需要采用各种标准化方法来消除这些差异。EMP_decostand继承了vegan包的decostand函数，可以便捷的使用对数比、相对值、中心对数比等方法进行数据标准化。注意EMP_decostand函数中的bySample参数可以控制按照样本内标准化或者按照特征内标准化。不做特殊设定时，bySample将按照vegan包内的建议执行。 5.4.1 示例1 从微生物组学中提取科级别数据，并将其绝对丰度转化为相对丰度。 MAE |> EMP_collapse(experiment='taxonomy',estimate_group = 'Family',collapse_by = 'row') |> EMP_decostand(method = 'relative') 5.4.3 示例2： 将基因组数据进行对数转换。注意：当使用log、pa和integer标准化方法时，无需考虑标准化方向。 MAE |> EMP_decostand(experiment = 'host_gene',method = 'log',logbase = 2) Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 16:57:19 "},"MD/5.5 数据插补 EMP_impute.html":{"url":"MD/5.5 数据插补 EMP_impute.html","title":"5.5 EMP_impute","keywords":"","body":"5.5 数据插补 EMP_impute 数据插补是指当数据集中存在缺失值时，通过算法对这些缺失值进行估计或填充的过程。数据插补的目的是在缺失值的位置上提供合理的估计值，以便在后续的数据分析或建模过程中更好地利用这些数据。EMP_impute模块基于链式随机森林（Chained Random Forests, CRF）算法进行数据插补，该算法较一般的均值、众数插补更具有科学性，不仅可用于插补连续型变量，还可用于插补分类变量。EMP_impute提供了对于assay、rowdata和coldata三个部分数据的插补功能。 5.5.1 插补coldata数据 在临床队列研究中，受试者的表型信息包含检验信息、量表信息和个人信息等等。受限于多种因素的影响，受试者的表型信息经常出现不同程度的缺失值。EMP_impute可以根据其他表型数据对进行插补。 插补前： 可以观察到该组内内的样本表型数据存在大量缺失值。 MAE |> EMP_assay_extract('geno_ec') |> EMP_coldata_extract() 可以根据全部表型数据对于缺失值进行插补 MAE |> EMP_assay_extract('geno_ec') |> EMP_impute() |> EMP_coldata_extract() 也可以只对部分数据进行插补，例如只对PHQ9和GAD7。 MAE |> EMP_assay_extract('geno_ec') |> EMP_impute(.formula = PHQ9+GAD7 ~ .) |> EMP_coldata_extract() 5.5.2 插补assay数据 组学数据的丰度矩阵通常不会出现缺失值，当使用插补功能时候会提示数据无缺失值。 MAE |> EMP_assay_extract('geno_ec') |> EMP_impute(coldata = F,assay = T) 5.5.3 插补rowdata数据 组学数据特征信息的缺失值主要源于数据库注释的不完善所致，因此虽然EMP_impute可以使用参数rowdata=T进行插补，但是插补的结果难以满足实际需要，因此不建议插补rowdata。 Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 16:57:42 "},"MD/5.6 确定核心数据 EMP_identify_assay.html":{"url":"MD/5.6 确定核心数据 EMP_identify_assay.html","title":"5.6 EMP_identify_assay","keywords":"","body":"5.6 确定核心数据 EMP_identify_assay 传统组学数据中，存在着大量稀疏的特征，比如微生物OTU/ASV注释表有着大量丰度极低菌种。这些稀疏特征有可能是样本污染、建库错误、测序偏倚或者注释失败等原因导致。为了简化计算或者减小这些数据干扰，本模块提供了两种方法进行过滤原始数据。 5.6.1 核心微生物数据 在微生物注释分析的结果中，可以发现存在相当多的”稀有物种“（相对丰度较低或者在样本中出现的频率较低），对于识别组间具有差异性的物种造成极强的干扰，尤其是在筛选关键物种时，机器学习算法(例如：随机森林、LEFse），很容易将这些“稀有物种”识别为组间的“差异物种”，因此，有必要在正式分析前将这些“稀有物种”根据统一的标准进行过滤。EMP_identify_assay模块引入了两个重要参数帮助过滤：minnum（即“最小相对丰度”）和minratio（即“最小占比”）。首先，在微生物数据中，低于指定“最小相对丰度”的任何丰度都会转换为 0。随后，当某个物种在任意一组样本中高于”最小相对丰度“的样本数量占该分组下样本总数量的比例大于”最小占比“时，该物种就被认为是”核心物种“，而其余物种都被归类为“稀有物种”并被过滤掉。 使用函数EMP_assay_extract提取实验数据taxonomy。使用函数EMP_identify_assay过滤获取“核心物种”，参数estimate_group指定将Group作为分组信息，参数min指定“最小相对丰度”为0.01，参数min_ratio指定“最小占比”为0.7。注意：当输入的微生物数据为”绝对丰度“时，在计算过程中，EMP_identify_assay模块会自动将其转换为相对丰度，以便在计算过程中进行过滤和获取“核心物种”，再根据过滤条件重新输出对应的绝对丰度的数据。 MAE |> EMP_assay_extract('taxonomy') |> EMP_identify_assay(estimate_group = 'Group',method = 'default', min=0.01,min_ratio = 0.7) 5.6.2 核心基因组数据 ​ 在基因组数据中，edgeR包提供了一种基于最小丰度值计算的过滤方法。EMP_assay_extract可以方便调用该方法对于基因组/转录组等数据进行规律。 MAE |> EMP_assay_extract('geno_ec') |> EMP_identify_assay(method = 'edgeR',min = 10,min_ratio = 0.7,estimate_group = 'Group') Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 23:53:13 "},"MD/5.7 修改数据 EMP_modify_assay.html":{"url":"MD/5.7 修改数据 EMP_modify_assay.html","title":"5.7 EMP_modify_assay","keywords":"","body":"5.7 调整数据 EMP_modify_assay 在通常情况下，EMP_identify_assay函数可以很好地处理实验数据。但在某些特殊情况下，手动修改测量数据才能帮助解决问题。例如：在基因表达数据中，有时候会存在表达量为零的情况，但这并不意味着基因没有表达，而可能是由于测量噪音或其他原因导致；为了避免出现除数为零的情况，并且保留这些零值可能包含的信息，通常会将这些零值替换为一个很小的非零值，如0.0001；这样可以在一定程度上保持数据的结构，同时避免了数值计算中的错误。 原始数据： MAE |> EMP_assay_extract('geno_ec') 调整示例1： ​ 使用函数EMP_assay_extract将实验数据中的零值替换为伪计数0.0001。 MAE |> EMP_assay_extract('geno_ec') |> EMP_modify_assay('==0',pseudocount=0.0001) 调整示例2： ​ 使用函数EMP_modify_assay将实验数据中小于阈值10的绝对丰度值转换为伪计数5。 MAE |> EMP_assay_extract('geno_ec') |> EMP_modify_assay(' Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 23:53:08 "},"MD/5.8 数据重抽样 EMP_rrarefy.html":{"url":"MD/5.8 数据重抽样 EMP_rrarefy.html","title":"5.8 EMP_rrarefy","keywords":"","body":"5.8 数据重抽样 EMP_rrarefy 在进行二代高通量测序时，各样本的测序深度存在差异。特别是微生物组学数据分析时，一般会基于数据内样本的最小测序深度为标准，对全部样本的数据进行有放回的重抽样，以确保全部样本的测序深度在一个水平上。 5.8.1 显示当前组学测序深度 MAE |> EMP_rrarefy(experiment = 'taxonomy',only_show_depth=T) 5.8.2 按照当前数据内样本的最小测序深度重抽样 注意：由于全部样本均达到这个最小深度阈值，因此EMP_rrarefy函数不会过滤任何样本。 MAE |> EMP_rrarefy(experiment = 'taxonomy') 5.8.3 按照制定测序深度重抽样 注意：用户可以通过指定参数raresize来自定义测序深度阈值。在过程中，任何低于该测序深度阈值的样本会被过滤，或者重抽样后部分特征在全部样本中均不存在时也会被过滤。 MAE |> EMP_rrarefy(experiment = 'taxonomy',raresize=8000) Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 17:00:05 "},"MD/6 数据分析 Data Analysis.html":{"url":"MD/6 数据分析 Data Analysis.html","title":"Chapter 6 Data Analysis :","keywords":"","body":"6.1 数据分析 Data Analysis : 欢迎阅读本章教程，本教程旨在为您提供全面的数据分析指南。通过本教程，您将学习如何使用多种数据分析方法处理多组学数据，包括不限于数据标准化、数据折叠、差异分析、关联分析、富集分析、特征筛选等主流生物信息学分析手段。各个功能模块可以轻松无缝对接，使整个分析流程标准化和清晰化，确保分析结果的科学性和可重复性。 Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-08 00:33:11 "},"MD/6.1 α多样性分析 EMP_alpha_analysis.html":{"url":"MD/6.1 α多样性分析 EMP_alpha_analysis.html","title":"6.1 EMP_alpha_analysis","keywords":"","body":"6.1 α多样性分析 EMP_alpha_analysis α多样性分析是最常用的微生物下游分析方法之一，主要用于评估物种的丰富度。EMP_alpha_analysis模块基于相对丰度数据，内置了六种常见的α多样性分析方法，包括：shannon指数、simpson指数、invsimpson指数、observerd_index、chao1、 ACE；并提供了常规的统计分析和可视化功能。 6.1.1 使用绝对丰度进行多样性分析 MAE |> EMP_assay_extract(experiment='taxonomy') |> EMP_alpha_analysis() 6.1.2 使用相对丰度进行多样性分析 注意：当使用相对丰度时，部分alpha指数（如ACE、Chao1）将无法计算。 MAE |> EMP_assay_extract(experiment='taxonomy') |> EMP_decostand(method = 'relative') |> EMP_alpha_analysis() 6.1.3 对接可视化差异分析 MAE |> EMP_assay_extract(experiment='taxonomy') |> EMP_alpha_analysis() |> EMP_boxplot(estimate_group='Group',method='t.test') Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 17:18:48 "},"MD/6.2 聚类分析 EMP_cluster_analysis.html":{"url":"MD/6.2 聚类分析 EMP_cluster_analysis.html","title":"6.2 EMP_cluster_analysis","keywords":"","body":"6.3 聚类分析 EMP_cluster_analysis 聚类分析属于机器学习中非监督学习的范畴，其不需要预先设置分组，而是根据数据本身的特性研究分类方法，并遵循这个分类方法对数据进行合理的分类，最终将相似数据分为一组，从而帮助用户发现数据的模式和结构，识别离群值。 6.3.1 根据assay对样本进行聚类分析 例如提取EC酶的注释结果，采用聚类分析观察样本的聚类情况。 MAE |> EMP_assay_extract(experiment = 'geno_ec') |> EMP_cluster_analysis() 可以使用h参数，进行聚类分组标记。 MAE |> EMP_assay_extract(experiment = 'geno_ec') |> EMP_cluster_analysis(h=0.15) 使用EMP_filter模块对分组为1和4的离群样本进行过滤。 MAE |> EMP_assay_extract(experiment = 'geno_ec') |> EMP_cluster_analysis(h=0.15) |> EMP_filter(sample_condition = cluster != c(1,4)) 6.3.2 根据assay对特征进行聚类分析 EMP_cluster_analysis也可以对特征进行聚类分析，以快速发现感兴趣的特征群体之间的丰度关系。例如我们可以利用EMP_assay_extract快速查找和酒精相关的KO基因，并根据丰度值观察基因之间的层级关系。 MAE |> EMP_assay_extract(experiment='geno_ko', pattern = 'alcohol',pattern_ref = 'Name') |> EMP_cluster_analysis(rowdata = T) 6.3.3 根据coldata对样本进行聚类分析 在临床数据分析中，受试者的表型数据一般包含基本信息，例如饮食数据、两边数据等。EMP_colda_extract模块可以将coldata转换成assay进行下游分析。例如，我们可以使用参数action='add'将示例数据中受试者的基本信息进行聚类分析。注意：1. 当coldata表型数据较多时，可以使用coldata_to_assay参数选择所需要转换的表型数据。如果未指定，则默认将coldata中全部的数值变量转换为assay。2. 某样本的部分特征存在缺失值，当计算样本聚类时默认该样本与其他样本的距离为1，而当计算特征聚类时，则自动计算无缺失值部分的特征数据。用户可以使用参数pseudodist进行调节，或者使用EMP_impute模块进行插补缺失值。 MAE |> EMP_coldata_extract(action = 'add', coldata_to_assay = c('SAS','SDS','HAMA','HAMD','PHQ9','GAD7')) |> EMP_cluster_analysis() MAE |> EMP_coldata_extract(action = 'add', coldata_to_assay = c('SAS','SDS','HAMA','HAMD','PHQ9','GAD7')) |> EMP_cluster_analysis(rowdata=TRUE) Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 17:22:24 "},"MD/6.3 相关性分析 EMP_cor_analysis.html":{"url":"MD/6.3 相关性分析 EMP_cor_analysis.html","title":"6.3 EMP_cor_analysis","keywords":"","body":"6.3 相关性分析 EMP_cor_analysis 多组学数据分析中，经常使用相关系数矩阵来观察特征之间的相互关系。 6.3.1 示例1：探究微生物科级别核心丰度与受试者的问卷量表之间的关系。 首先从MAE容器中提取微生物组学数据，利用EMP_identify_assay筛选核心微生物，利用EMP_collapse折叠出科级别数据，最后在利用EMP_decostand完成相对丰度的标准化。 micro_data EMP_assay_extract('taxonomy') |> EMP_identify_assay(method='default') |> EMP_collapse(estimate_group = 'Genus',collapse_by = 'row') |> EMP_decostand(method='relative') micro_data 其次，提取微生物组学中样本表型数据中的量表结果。 meta_data EMP_assay_extract('taxonomy') |> EMP_coldata_extract(action = 'add', coldata_to_assay = c('SAS','SDS','HAMA','HAMD','PHQ9','GAD7')) meta_data 最后直接使用+将两个组学数据合并成EMP对象，使用EMP_cor_analysis和EMP_heatmap_plot模块完成相关性分析及可视化。 (micro_data + meta_data) |> EMP_cor_analysis() |> EMP_heatmap_plot(label_size=2,palette='Spectral', clust_row=TRUE,clust_col=TRUE) 6.3.2 示例2：探究微生物差异功能基因与宿主差异基因表达之间的的关系 首先，从MAE对象中提取微生物差异功能的KO基因集和宿主转录组基因集，利用EMP_identify_assay过滤稀疏基因，利用EMP_diff_analysis 进行DESeq2差异分析并考虑区域因素导致的批次问题，筛选出p值小于0.05的差异KO。 ko_data EMP_assay_extract('geno_ko') |> EMP_identify_assay(method='edgeR') |> EMP_diff_analysis(method='DESeq2',.formula = ~Region+Group) |> EMP_filter(feature_condition = pvalue host_gene EMP_assay_extract('host_gene') |> EMP_identify_assay(method='edgeR') |> EMP_diff_analysis(method='DESeq2',.formula = ~Region+Group) |> EMP_filter(feature_condition = pvalue 最后直接使用+将两个组学数据合并成EMP对象，使用EMP_cor_analysis和EMP_heatmap_plot模块完成相关性分析及可视化。 (ko_data + host_gene) |> EMP_cor_analysis() |> EMP_heatmap_plot() 6.3.3 示例3：探究微生物-功能基因-代谢产物-宿主基因-表型数据之间的多重相关性 EMP_cor_analysis模块能够计算多个组学之间的相互关系。我们可以分别计算各个组学之间的差异特征，使用+将组学合并在一起，并按照组合顺序进行相关性检验。EMP_sankey_plot可以根据多重相关性结果，绘制相关性桑基图。注意：1. 相关性桑基图中，红色为正相关，蓝色为负相关。2. 相关性桑基图会评估每个节点之间的相互关系，孤立的节点将会被过滤。参数pvalue和rvalue可以调节边的数量。 micro_data EMP_assay_extract('taxonomy') |> EMP_identify_assay(method='default') |> EMP_collapse(estimate_group = 'Genus',collapse_by = 'row') |> EMP_decostand(method='relative') ko_data EMP_assay_extract('geno_ko') |> EMP_identify_assay(method='edgeR') |> EMP_diff_analysis(method='DESeq2',.formula = ~Region+Group) |> EMP_filter(feature_condition = pvalue EMP_assay_extract(experiment = 'untarget_metabol') |> EMP_collapse(estimate_group = 'MS2kegg',collapse_by='row', na_string = c(\"NA\", \"null\", \"\",\"-\"), method = 'mean',collapse_sep = '+') |> EMP_decostand(method = 'relative') |> EMP_dimension_analysis(method = 'pls',estimate_group = 'Group') |> EMP_filter(feature_condition = VIP >2) host_gene EMP_assay_extract('host_gene') |> EMP_identify_assay(method='edgeR') |> EMP_diff_analysis(method='DESeq2',.formula = ~Region+Group) |> EMP_filter(feature_condition = pvalue EMP_assay_extract('taxonomy') |> EMP_coldata_extract(action = 'add', coldata_to_assay = c('SAS','SDS','HAMA','HAMD','PHQ9','GAD7')) (micro_data + ko_data + metabolite_data + host_gene + meta_data) |> EMP_cor_analysis() |> EMP_sankey_plot() Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 17:27:42 "},"MD/6.4 差异性分析 EMP_diff_analysis.html":{"url":"MD/6.4 差异性分析 EMP_diff_analysis.html","title":"6.4 EMP_diff_analysis","keywords":"","body":"6.4 差异性分析 EMP_diff_analysis 该模块帮助处理实验数据在不同分组条件下差异分析，统计方法包含传统差异分析方法T检验、wilcox、oneway.test、kruskal.test以及DESeq2、edgeR和limma等方法。本模块不仅支持多核并行运算提高运算效率且支持缓存快照功能。当重复使用相同参数进行计算时，将自动提取已经缓存的结果，不必重新计算。 6.4.1 传统统计学方法 使用T检验方法快速统计微生物数据核心属级别数据的差异情况，并使用bonferroni对多重检验的P值矫正。注意：sign_group表示在该特征在组间平均丰度较高的分组信息，并不完全等价于该特征在此分组中显著增高。 MAE |> EMP_assay_extract('taxonomy') |> EMP_identify_assay(method='default',estimate_group = 'Group') |> EMP_collapse(estimate_group = 'Genus',collapse_by = 'row') |> EMP_diff_analysis(method='t.test',estimate_group = 'Group',p.adjust = 'bonferroni') ​ 对于超过两个分组，可以使用 oneway.test或者kruskal.test方法。EMP_diff_analysis继承了R内置的stats方法，可以在函数内增加其参数进行调整。注意：在多分组差异分析或者输入数据非couts,relative和·integer时，将不再提供fold_change、VS等信息。 6.4.2 DESeq2、edgeR和limma等方法 使用DESeq2对宿主基因数据集按照性别分组进行差异分析。注意在使用这些方法时，指定分组信息将不再使用estimate_group参数，而是遵循原有包的习惯使用.formula写法。 MAE |> EMP_assay_extract('host_gene') |> EMP_diff_analysis(method='DESeq2',.formula = ~Sex) 使用edgeR的几种模式方法 MAE |> EMP_assay_extract('host_gene') |> EMP_diff_analysis(method='edgeR_quasi_likelihood',.formula = ~Sex) MAE |> EMP_assay_extract('host_gene') |> EMP_diff_analysis(method='edgeR_likelihood_ratio',.formula = ~Sex) 更多方法自行尝试 MAE |> EMP_assay_extract('host_gene') |> EMP_diff_analysis(method='edger_robust_likelihood_ratio',.formula = ~Sex) MAE |> EMP_assay_extract('host_gene') |> EMP_diff_analysis(method='limma_voom',.formula = ~Sex) MAE |> EMP_assay_extract('host_gene') |> EMP_diff_analysis(method='limma_voom_sample_weights',.formula = ~Sex) 6.4.3 差异分析过滤及可视化 ​ EMP_filter模块可以快速帮助筛选结果文件，详细用法可以参考 EMP_filter模块帮助文档 MAE |> EMP_assay_extract('geno_ko') |> EMP_diff_analysis(method='DESeq2',.formula = ~Group) |> EMP_filter(feature_condition = pvalue 1.5 ) 对差异分析结果绘制火山图。注意：在EMP_volcanol_plot中增加show='html'可以提供可交互式图形，便于快速确定差异特征的具体信息。 MAE |> EMP_decostand(experiment = 'geno_ec',method = 'integer') |> EMP_diff_analysis(method='DESeq2',.formula = ~Group) |> EMP_volcanol_plot(key_feature = c('3.6.1.62','1.5.3.19'), min.segment.length = 0, seed = 42, box.padding = 0.5) ## Add arrow Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 23:50:20 "},"MD/6.5 降维分析 EMP_dimension_analysis.html":{"url":"MD/6.5 降维分析 EMP_dimension_analysis.html","title":"6.5 EMP_dimension_analysis","keywords":"","body":"6.5 降维分析 EMP_dimension_analysis 该模块支持多维数据的降维分析，降维方法包含主成分分析PCA, 主坐标分析PCoA, 偏最小二乘回归PLS和正交偏最小二乘回归OPLS四种方法。 6.5.1 示例1：探究微生物核心属级别数据的beta多样性及其可视化 首先从MAE容器中提取微生物组学数据，利用EMP_identify_assay筛选核心微生物，利用EMP_collapse折叠出属级别数据，再使用EMP_dimension_analysis进行PCoA降维分析。 MAE |> EMP_assay_extract('taxonomy') |> EMP_identify_assay(method='default',estimate_group = 'Group') |> EMP_collapse(estimate_group = 'Genus',collapse_by = 'row') |> EMP_dimension_analysis(method = 'pcoa',distance='bray') 最后，降维分析的结果可以使用EMP_scatterplot进行可视化。注意show参数可以从三个维度观察降维结果并提供html交互式图形展示。 MAE |> EMP_assay_extract('taxonomy') |> EMP_identify_assay(method='default',estimate_group = 'Group') |> EMP_collapse(estimate_group = 'Genus',collapse_by = 'row') |> EMP_dimension_analysis(method = 'pcoa',distance='bray') |> EMP_scatterplot(estimate_group='Group',show='p12html',ellipse=0.3) 6.5.2 示例2：探究代谢组学数据PLS降维分析并筛选特征代谢产物 从MAE对象容器中提取非靶向代谢组学数据，根据二级代谢产物KEGG注释折叠数据并进行相对丰度转化，再进行PLS降维分析，获取代谢产物的降维坐标及VIP值，最后根据VIP值筛选特征代谢产物。 MAE |> EMP_assay_extract(experiment = 'untarget_metabol') |> EMP_collapse(estimate_group = 'MS2kegg',collapse_by='row', na_string = c(\"NA\", \"null\", \"\",\"-\"), method = 'mean',collapse_sep = '+') |> EMP_decostand(method = 'relative') |> EMP_dimension_analysis(method = 'pls',estimate_group = 'Group') |> EMP_filter(feature_condition = VIP >2) Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 17:30:23 "},"MD/6.6 富集分析 EMP_enrich_analysis.html":{"url":"MD/6.6 富集分析 EMP_enrich_analysis.html","title":"6.6 EMP_enrich_analysis","keywords":"","body":"6.6 富集分析 EMP_enrich_analysis KEGG（Kyoto Encyclopedia of Genes and Genomes）富集分析是一种生物信息学方法，用于确定一组基因或蛋白质在特定的生物学通路或功能中是否显著富集。KEGG数据库包含了大量的基因和基因产物的功能信息，以及这些基因在代谢通路、信号传导通路和疾病通路中的作用。本模块可以在线读取KEGG数据库信息，完成富集分析的常规步骤。 6.6.1 基于KO/EC注释的KEGG富集分析 宏基因组微生物数据分析中可以得到KO/EC的功能基因注释结果，使用EMP_diff_analysis获取差异分析基因，并利用EMP_enrich_analysis进行KEGG富集分析。注意：1.KEGG_Type可以指定按照pathway富集或者Module富集。2. species 默认使用全物种数据作为背景基因，也可以指定具体物种数据作为背景基因进行富集。3. 可以修改condition根据pvalue或者校正P值进行筛选差异基因。 MAE |> EMP_assay_extract(experiment = 'geno_ec') |> EMP_diff_analysis(method='DESeq2',.formula = ~Group) |> EMP_enrich_analysis(condition = pvalue EMP_dotplot和EMP_netplot继承了enrichplot包的dotplot和cnetplot可以对富集分析的结果进行可视化。 MAE |> EMP_assay_extract(experiment = 'geno_ec') |> EMP_diff_analysis(method='DESeq2',.formula = ~Group) |> EMP_enrich_analysis(condition = pvalue EMP_dotplot() MAE |> EMP_assay_extract(experiment = 'geno_ec') |> EMP_diff_analysis(method='DESeq2',.formula = ~Group) |> EMP_enrich_analysis(condition = pvalue EMP_netplot() 6.6.2 基于基因名称的的KEGG富集分析 这类数据常见于宿主组织的Bulk 转录组数据。在进行分析前，需要使用EMP_feature_convert将基因的symbol转换成entrezid。 MAE |> EMP_assay_extract(experiment = 'host_gene') |> EMP_feature_convert(from = 'symbol',to='entrezid',species='Human') |> EMP_diff_analysis(method = 'DESeq2', .formula = ~Group,p.adjust = 'fdr') |> EMP_enrich_analysis(keyType ='entrezid', KEGG_Type ='KEGG',pvalue 6.6.3 基于代谢产物的KEGG富集分析 这类数据主要是代谢组学产生，富集分析前需要将特征名称转换为compund ID。 MAE |> EMP_assay_extract(experiment = 'untarget_metabol')|> EMP_collapse(na_string=c('NA','null','','-'), estimate_group = 'MS2kegg',method = 'sum',collapse_by = 'row') |> EMP_diff_analysis(method='DESeq2',.formula = ~Group) |> EMP_enrich_analysis(keyType ='cpd', KEGG_Type ='KEGG',pvalue Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-08 00:43:15 "},"MD/6.7 标志物分析 EMP_marker_analysis.html":{"url":"MD/6.7 标志物分析 EMP_marker_analysis.html","title":"6.7 EMP_marker_analysis","keywords":"","body":"6.7 标志物分析 EMP_marker_analysis 该模块旨在使用机器学习算法寻找多组学数据内的关键特征。需要注意的是，在组学数据分析中，机器学习模型的使用方法有两种。第一种是利用机器学习算法筛选具有潜在标志物能力的特征，第二种是利用组学数据构建机器学习预测模型，辅助区分分组。由于构建预测模型，往往需要多种调参优化，粗暴的使用默认参数，常常难以得到立项的结果。因此EMP_marker_analysis模块被设计为辅助用户满足快速筛选潜在标志物，并非构建和优化预测模型。 6.7.1 基于Boruta算法估计特征的重要性 使用Boruta算法可以根据coldata中的分类，快速将数据中的特征按照Confirmed, Tentative和Rejected三类。注意：调整参数action='get'可以获得模型计算的结果及构建的模型本身。 MAE |> EMP_marker_analysis(experiment = 'geno_ec',method = 'boruta', estimate_group = 'Group') 可以使用EMP_filter函数快速筛选所需要的特征，便于其他下游分析。注意：此筛选方法适用于以下所有模型。 MAE |> EMP_marker_analysis(experiment = 'geno_ec',method = 'boruta', estimate_group = 'Group') |> EMP_filter(feature_condition = Boruta_decision != 'Rejected') 6.7.2 基于randomforest算法估计特征的重要性 基于随机森林分类进行特征重要性评估 MAE |> EMP_marker_analysis(experiment = 'geno_ec',method = 'randomforest', estimate_group = 'Group') 基于随机森林回归进行特征重要性评估 MAE |> EMP_marker_analysis(experiment = 'geno_ec',method = 'randomforest', estimate_group = 'BMI') 6.7.3 基于xgboost算法估计特征的重要性 基于xgboost算法分类进行特征重要性评估。注意：使用xgboost算法时，需要用objective制定模型。二分类时候选择binary:logistic，多分类时选择multi:softmax。 MAE |> EMP_marker_analysis(experiment = 'geno_ec',method = 'xgboost',xgboost_run='classify', estimate_group = 'Group',objective = 'binary:logistic') 基于xgboost算法回归进行特征重要性评估。 MAE |> EMP_marker_analysis(experiment = 'geno_ec',method = 'xgboost',xgboost_run='regression', estimate_group = 'BMI',objective = 'reg:squarederror') 6.7.4 基于Lasso算法估计特征的重要性 MAE |> EMP_marker_analysis(experiment = 'geno_ec',method = 'lasso', estimate_group = 'BMI') Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 17:34:44 "},"MD/6.8 GSEA富集分析 EMP_GSEA_analysis.html":{"url":"MD/6.8 GSEA富集分析 EMP_GSEA_analysis.html","title":"6.8 EMP_GSEA_analysis","keywords":"","body":"6.8 GSEA富集分析 EMP_GSEA_analysis GSEA（Gene Set EnrichmentAnalysis），即基因集富集分析，其基本思想是使用预定义的基因集（通常来自功能注释或先前实验的结果），将关注基因按照计算值从高到低排序，然后检验预定义的基因集是否在这个排序表的顶端或者底端富集。 6.8.1 基于信噪比signal2Noise排序 signal2Noise的方法是基于GSEA官网提供的计算方式，对目标基因集进行排序。 MAE |> EMP_GSEA_analysis(experiment = 'geno_ko',method='signal2Noise', estimate_group = 'Group', pvalueCutoff = 0.05,keyType = 'ko') 6.8.2 基于相关性排序 基于相关性排序算法中，可以设置threshold_r和threshold_p根据相对系数绝对值和P值进行过滤。当低于这两个阈值的任何一种，此特征将会从排序表中剔除。 MAE |> EMP_GSEA_analysis(experiment = 'geno_ko',method='cor', estimate_group = 'BMI',cor_method = 'spearman', threshold_r = 0.3,threshold_p = 0.05, ###### filter by coe and pvalue pvalueCutoff = 0.05,keyType = 'ko',KEGG_Type = 'KEGG') 6.8.3 基于差异分析log2FC排序 基于相关性排序算法中，可以设置pvalue阈值剔除不需要的特征。 MAE |> EMP_diff_analysis(experiment = 'geno_ec',method='DESeq2',.formula = ~0+Group, group_level=c('Group_A','Group_B')) |> EMP_GSEA_analysis(method='log2FC',pvalue 6.4 GSEA的可视化 MAE |> EMP_GSEA_analysis(experiment = 'geno_ko',method='signal2Noise', estimate_group = 'Group', pvalueCutoff = 0.05,keyType = 'ko') |> EMP_curveplot(geneSetID='map00680') MAE |> EMP_GSEA_analysis(experiment = 'geno_ko',method='signal2Noise', estimate_group = 'Group', pvalueCutoff = 0.05,keyType = 'ko') |> EMP_dotplot() Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-08 00:43:49 "},"MD/6.9 EMP_WGCNA_cluster_analysis.html":{"url":"MD/6.9 EMP_WGCNA_cluster_analysis.html","title":"6.9 EMP_WGCNA_cluster_analysis","keywords":"","body":"6.9 WGCNA聚类分析 EMP_WGCNA_cluster_analysis 加权基因共表达网络分析（Weighted correlation network analysis，WGCNA）旨在寻找协同表达的基因模块(module)，并探索基因网络与关注的表型之间的关联，以及探索网络中的核心基因。本模块可帮助用户完成基因表达的聚类分析，参数RsquaredCut 可指定期望最小拟合自由拓扑指数 R² 的阈值（拟合自由拓扑指数 R² 反映了共表达网络的模块化程度，数值越接近 1 表示模块化程度越高，即模块内的基因之间存在高度相关性且模块的划分更加清晰）。设置一个较高的 RsquaredCut 值会鼓励算法生成更具有模块化结构的共表达网络，但可能会导致较少的模块或者更大的模块；反之，设置较低的 RsquaredCut 值可能会产生更多的模块，但这些模块可能会更加松散或混杂。 6.9.1 WGCNA聚类模块 本模块集成了WGCNA包的相关函数，可以快速完成基于WCGNA算法的聚类。 MAE |> EMP_assay_extract('geno_ec') |> EMP_WGCNA_cluster_analysis(RsquaredCut = 0.85) 注意EMP_WGCNA_cluster_analysis继承了WGCNA包WGCNA_blockwiseModules的用法，可以调整模块聚类效果。 MAE |> EMP_assay_extract('geno_ec') |> EMP_WGCNA_cluster_analysis(RsquaredCut = 0.85,mergeCutHeight=0.4) 6.9.2 WGCNA聚类模块的过滤 此模块聚类分析的结果，可以使用EMP_filter模块进行筛选。此功能在后续功能富集分析中有着广泛应用。 MAE |> EMP_assay_extract('geno_ec') |> EMP_WGCNA_cluster_analysis(RsquaredCut = 0.85,mergeCutHeight=0.4) |> EMP_filter(feature_condition = WGCNA_color=='green') Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 17:40:12 "},"MD/6.10 EMP_WGCNA_cor_analysis.html":{"url":"MD/6.10 EMP_WGCNA_cor_analysis.html","title":"6.10 EMP_WGCNA_cor_analysis","keywords":"","body":"6.10 EMP_WGCNA_cor_analysis 在WGCNA聚类分析后，本模块将聚类模块使用PCA方法进行降维，使用解释度最大的轴与目标数据进行关联分析，从而探究那些聚类数据具有潜在后续分析的价值。 6.10.1 示例一：基于单一组学与表型数据的WGCNA分析 从示例数据中提取EC酶的注释组学，使用edgeR的方法过滤稀疏数据后采用WGCNA聚类，并与表型数据进行关联系，最后绘制成热图。 MAE |> EMP_assay_extract('geno_ec') |> EMP_identify_assay(method = 'edgeR',estimate_group = 'Group') |> EMP_WGCNA_cluster_analysis(RsquaredCut = 0.85,mergeCutHeight=0.4) |> EMP_WGCNA_cor_analysis(coldata_to_assay = c('BMI','PHQ9','GAD7','HAMD','SAS','SDS'), method='spearman') |> EMP_heatmap_plot() 得到WGCNA关联分析热图后，可以选择与目标数据相关的模块进一步下游差异和富集分析。 MAE |> EMP_assay_extract('geno_ec') |> EMP_identify_assay(method = 'edgeR',estimate_group = 'Group') |> EMP_WGCNA_cluster_analysis(RsquaredCut = 0.85,mergeCutHeight=0.4) |> EMP_WGCNA_cor_analysis(coldata_to_assay = c('BMI','PHQ9','GAD7','HAMD','SAS','SDS'), method='spearman') |> EMP_filter(feature_condition = WGCNA_color=='black') |> EMP_diff_analysis(method = 'DESeq2',.formula = ~Group) |> EMP_enrich_analysis(keyType = 'ec',KEGG_Type = 'MKEGG') |> EMP_dotplot() 6.10.2 示例二：基于多个组学之间进行WGCNA分析 从示例数据中提取EC酶组学并进行WGCNA聚类分析，再提取宿主基因组学的部分兴趣基因（这里也可以使用差异分析等方案选择目标基因）。 使用+连接两个组学，并进行WGCNA相关性分析。注意在此模式下，默认会从第一个组学中提取WGCNA聚类结果与第二个组学进行WGCNA相关分析，因此注意使用+合并组学的顺序。 k1 EMP_assay_extract('geno_ec') |> EMP_identify_assay(method = 'edgeR',estimate_group = 'Group') |> EMP_WGCNA_cluster_analysis(RsquaredCut = 0.85,mergeCutHeight=0.4) k2 EMP_assay_extract('host_gene',pattern = c('A1BG','A1CF','A2MP1','AACS'), pattern_ref = 'feature') (k1 + k2) |> EMP_WGCNA_cor_analysis(method='spearman') |> EMP_heatmap_plot(palette = 'Spectral') Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 17:40:58 "},"MD/6.11 联合分析 EMP_multi_analysis.html":{"url":"MD/6.11 联合分析 EMP_multi_analysis.html","title":"6.11 EMP_multi_analysis","keywords":"","body":"6.11 组学联合分析 EMP_multi_analysis 该模块旨在通过统计分析方法将多个统计显著性结果整合到一个综合的结果中。通过参数method指定联合分析的方法，包括：feature、diff_feature_enrich和same_feature_enrich。 6.11.1 融合不同研究队列中相同特征的统计结果 这种场景多见于，不同研究队列对于同一个研究目标进行分析，但是分析结果存在差异。特别是在微生物研究中经常出现不同研究队列对于同一个疾病的微生物差异分析，多个微生物差异分析的结果存在不同。我们可以使用融合P值的技术对于多个统计学结果进行合并。 数据准备：从MAE数据容器中提取两个区域的微生物注释数据，并进行差异分析。 k1 EMP_assay_extract('taxonomy') |> EMP_filter(Region == 'Paris') |> EMP_diff_analysis(method = 'DESeq2',.formula = ~Group) k2 EMP_assay_extract('taxonomy') |> EMP_filter(Region == 'Guangzhou') |> EMP_diff_analysis(method = 'DESeq2',.formula = ~Group) 使用融合P的方法，融合两个差异分析的P值结果。注意：combineMethod提供三种融合P的方法：fisher，edgington 和 stouffer。注意：可以使用action='get'提取差异分析结果。 (k1+k2) |> EMP_multi_analysis(method = 'feature',combineMethod='edgington', p.adjust = 'BH') 6.11.2 融合不同研究队列中相同特征的KEGG富集结果 这种场景于上述列子近似，我们可以合并不同队列相同特征的KEGG富集结果。 数据准备：从MAE数据容器中提取两个区域的ko注释数据，并进行差异和富集分析。 k1 EMP_assay_extract('geno_ko') |> EMP_filter(Region == 'Paris') |> EMP_diff_analysis(method = 'DESeq2',.formula = ~Group) |> EMP_enrich_analysis(pvalue EMP_assay_extract('geno_ko') |> EMP_filter(Region == 'Guangzhou') |> EMP_diff_analysis(method = 'DESeq2',.formula = ~Group) |> EMP_enrich_analysis(pvalue 对于相同特征的的富集分析结果，本模块有三种方法可以进行融合：enchier, ActivePathways和mitch。其中当使用enchier方法时，采用的是P值融合算法。通过调整combineMethod参数，可以决定融合P值发生在特征水平还是富集分析结果水平。ActivePathways和mitch算法则依赖于已经发表的两个组学融合分析包。 (k1+k2) |> EMP_multi_analysis(method = 'same_feature_enrich', keyType = 'ko',combineFun='ActivePathways')|> EMP_dotplot() 6.11.3 融合相同队列不同特征的KEGG富集结果 这种场景多见于在同一个队列中进行了功能基因和代谢组学的测序分析。不同组学的KEGG富集分析的结果不同，单纯使用韦恩图求交并集并不能很好的揭示组学之间的富集情况。本模块可以利用算法将不同特征的组学的KEGG富集结果融合在一起。 数据准备：从MAE数据容器中提取KO注释结果和代谢组学结果，并分别完成KEGG富集分析。 k1 EMP_assay_extract('geno_ko') |> EMP_diff_analysis(method = 'DESeq2',.formula = ~Group) |> EMP_enrich_analysis(pvalue EMP_collapse(experiment = 'untarget_metabol',na_string=c('NA','null','','-'), estimate_group = 'MS2kegg',method = 'sum',collapse_by = 'row') |> EMP_diff_analysis(method = 'DESeq2',.formula = ~Group) |> EMP_enrich_analysis(pvalue 使用+将组学联合进行富集分析。 (k1+k2) |> EMP_multi_analysis(method = 'diff_feature_enrich') |> EMP_dotplot() Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-08 00:44:04 "},"MD/7 data support.html":{"url":"MD/7 data support.html","title":"Chapter 7 Data support :","keywords":"","body":"7. 数据辅助 EMP_support: 欢迎阅读本章教程，本教程旨在为您提供在EasyMultiProfiler数据分析流程中常用的辅助工具和方法。通过本教程，您将学习如何使用多种功能模块对数据及分析结果进行导入、筛选、提取、历史等功能。 Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-08 00:30:08 "},"MD/7.1 数据筛选 data_filter.html":{"url":"MD/7.1 数据筛选 data_filter.html","title":"7.1 EMP_filter","keywords":"","body":"7.1 数据筛选 EMP_filter 本模块有着强大的功能，不仅可以根据数据的rowdata和coldata对特征和样本进行筛选规律，还可以根据当前分析中已经完成的结果对数据进行筛选。 EMP_filter的基本参数： obj ： 选择组学名称，可以直接对接MAE对象进行操作 experiment ： 选择组学名称，可以直接对接MAE对象进行操作 sample_condition：设定选择样本的阈值条件 feature_condition: 设定选择特征的阈值条件 filterSample: 直接设定样本的名称 filterFeature: 直接设定特征的名称 action: 与filterSample和filterFeature联用，设定kick和select show_info: 设定输出结果的展现方式 7.1.1 针对整个队列全组学数据进行过滤筛选 示例一： 在全部组学中筛选满足年龄大于30岁的男性受试者。 MAE |> EMP_filter(sample_condition = Sex == 'M' & Age >30) 筛选完成后，MAE数据容器中只存在满足条件的样本，可以直接使用其他分析模块进行下游分析。例如可以使用EMP_coldata_extract观察过滤后样本情况。 MAE |> EMP_filter(sample_condition = Sex == 'M' & Age >30) |> EMP_coldata_extract() 示例二： EMP_filter继承了dplyr的filter函数语法，因此可以使用tidy语法进行样本筛选。 筛选出表型数据中没有缺失值的样本 MAE |> EMP_filter(sample_condition = if_all(everything(),~ !is.na(.))) 筛选出表型数据中PHQ9和GAD7至少有一个大于5分的样本 MAE |> EMP_filter(sample_condition = if_all(c(PHQ9,GAD7),~. > 5)) 7.1.2 针对单组学数据及分析结果进行过滤筛选 示例一： 从MAE容器中提取宿主转录组组学结果，筛选出全部的男性样本，并将其中的P70597样本剔除。 MAE |> EMP_assay_extract('host_gene') |> EMP_filter(Sex == 'M' & Age >30,filterSample = 'P70597',action = 'kick') 示例二： 本模块可以根据分析结果进行过滤样本和特征。从MAE容器中提取微生物组学数据，并进行alpha多样性分析，筛选满足特定条件的样本。 MAE |> EMP_assay_extract('taxonomy') |> EMP_alpha_analysis() |> EMP_filter(shannon > 2) 示例三： 从MAE容器中提取宿主转录组学数据进行差异分析，并筛选出校正P值小于0.05的特征。 MAE |> EMP_assay_extract('host_gene') |> EMP_diff_analysis(method = 'DESeq2',.formula = ~Group,p.adjust = 'BH') |> EMP_filter(feature_condition = BH 示例四 本模块支持多种分析结果组合筛选。 从MAE容器中提取EC酶注释结果进行WGCNA关联分析并进行DESeq2差异分析, 筛选出以下条件的数据: 年龄大于30岁的样本 2. WGCNA关联分析中与BMI密切相关的黑色模块聚类特征 3. 差异分析中p值小于0.05 MAE |> EMP_assay_extract('geno_ec') |> EMP_identify_assay(method = 'edgeR',estimate_group = 'Group') |> EMP_WGCNA_cluster_analysis(RsquaredCut = 0.85,mergeCutHeight=0.4) |> EMP_WGCNA_cor_analysis(coldata_to_assay = c('BMI','PHQ9','GAD7','HAMD','SAS','SDS'), method='spearman') |> EMP_heatmap_plot() |> # This step could help find the interesting module EMP_diff_analysis(method = 'DESeq2',.formula = ~Group) |> EMP_filter(sample_condition = Age >30, feature_condition = WGCNA_color == 'black' & pvalue 7.1.3 关于过滤后结果的清除问题 EasyMultiProfiler包的分析流程中会自动存储已经分析完成的结果在数据容器内以供EMP_filter模块进行筛选样本和特征。但是，当筛选完成后原有的结果可能不再适用，因此将会在本次筛选完成后清除。例如，当容器内存储了差异分析和多样性分析的结果，用户根据BMI剔除了部分样本，此时容器内存储的差异分析结果将不再有效会自动清除，但是alpha多样性的结果则不受剔除样本的影响，将仍会保存在容器内以供下一次筛选。本包已经设置了自动化来进行这一过程，并在清除受到影响的结果时，以红字的形式提醒用户。 Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 17:42:02 "},"MD/7.2 数据历史 EMP_history.html":{"url":"MD/7.2 数据历史 EMP_history.html","title":"7.2 EMP_history","keywords":"","body":"7.3 数据历史 EMP_history 本模块可以提取EasyMultiProfiler分析流程中任一结果的历史处理记录，方便用户追溯已经完成结果的数据分析流程。 7.3.1 追溯单组学分析的历史记录 k1 EMP_assay_extract('geno_ko') |> EMP_filter(Region == 'Paris') |> EMP_diff_analysis(method = 'DESeq2',.formula = ~Group) |> EMP_enrich_analysis(pvalue EMP_history() 7.3.2 追溯多组学分析的历史记录 k1 EMP_assay_extract('taxonomy') |> EMP_collapse(estimate_group = 'Genus',collapse_by = 'row') |> EMP_diff_analysis(method='DESeq2', .formula = ~Group) |> EMP_filter(feature_condition = pvalue EMP_collapse(experiment = 'untarget_metabol',na_string=c('NA','null','','-'), estimate_group = 'MS2kegg',method = 'sum',collapse_by = 'row') |> EMP_diff_analysis(method='DESeq2', .formula = ~Group) |> EMP_filter(feature_condition = pvalue 1.5) k3 EMP_assay_extract('geno_ec') |> EMP_diff_analysis(method='DESeq2', .formula = ~Group) |> EMP_filter(feature_condition = pvalue 2) #For two experinemnt p1 EMP_cor_analysis(method = 'spearman') |> EMP_heatmap_plot() ## Visualization p1 |> EMP_history() Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 17:42:13 "},"MD/7.3 数据结果提取和注入 EMP_result.html":{"url":"MD/7.3 数据结果提取和注入 EMP_result.html","title":"7.3 EMP_result","keywords":"","body":"7.3 数据分析结果的提取和注入 EMP_result 本模块可以提取EasyMultiProfiler分析流程中对象中存储的数据分析结果，并可以将符合格式要求的外部数据分析结果导入对象，联合在一起进行数据分析。 7.3.1 数据分析结果的提取 当对一个组学进行多次数据分析时，已经完成的数据分析结果被存储在数据对象中。EMP_result模块可以根据需求快速提取所需数据分析的原始结果。 result EMP_assay_extract('geno_ec') |> EMP_alpha_analysis() |> EMP_diff_analysis(method = 'DESeq2',.formula = ~Group) |> EMP_enrich_analysis(pvalue EMP_result(info = 'EMP_diff_analysis') alpha_re EMP_result(info = 'EMP_alpha_analysis') enrich_re EMP_result(info = 'EMP_enrich_analysis') 7.3.2 数据分析结果的注入 任何分析工具包都难以囊括全部的数据分析处理方式，EMP_result模块可以将外部其他软件分析的结果导入数据对象中，协同EasyMultiProfiler内的分析结果进行联合分析。 例如，我们可以使用外部的vegan包计算多样性并导入EMPT数据容器内。 首先提取丰度数据 tax_se EMP_assay_extract('taxonomy') assay_data EMP_assay_extract(action = 'get') 使用vegan包计算香浓多样性指数，并命名为new_shannon assay_data tibble::column_to_rownames('primary') shannon_index 注意：新增结果中的名称务必不要与数据内已经存在结果的名称出现重复，这会导致EMP_filter无法正常使用。例如在本示例中外部结果的shanon指数更名为new_shannon, 有效避免与EMP_alpha_analysis的结果名称重复。 ### inject the new result into EMPT object EMP_result(tax_se, value_name = 'new_alpha', affect_when_sample_changed=0, affect_when_feature_changed=1, attribute='primary', attribute2='normal',source='user_import') EMP_filter(sample_condition = new_shannon >4) Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 18:28:32 "},"MD/7.4 数据概览 EMP_summary.html":{"url":"MD/7.4 数据概览 EMP_summary.html","title":"7.4 EMP_summary","keywords":"","body":"7.4 数据概览 EMP_summary 本模块可以快速对于MultiAssayExperiment和EMP类进行概览可视化。 概览可视化分为三个部分。 Data dimention： Sample指当前组学内样本的数目，Feature指当前组学内特征的数目 Data information: Sample_attr指当前组学内样本的表型数据的分类数目，Feature_atrr指当前组学内特征注释的分类数目。例如taxonomy中的8，指特征注释存在界门纲目科属种株 8个级别的注释。 Data miss: Assay_status,Sample_status和Feature_status分别指当前组学的丰度矩阵、样本表型数据和特征注释中是否存在缺失值。 7.4.1 MultiAssayExperiment对象的概览可视化 data(MAE) MAE |> EMP_summary() 7.4.2 EMP对象的概览可视化 k1 EMP_assay_extract('taxonomy') |> EMP_collapse(estimate_group = 'Genus',collapse_by = 'row') |> EMP_diff_analysis(method='DESeq2', .formula = ~Group) |> EMP_filter(feature_condition = pvalue EMP_collapse(experiment = 'untarget_metabol',na_string=c('NA','null','','-'), estimate_group = 'MS2kegg',method = 'sum',collapse_by = 'row') |> EMP_diff_analysis(method='DESeq2', .formula = ~Group) |> EMP_filter(feature_condition = pvalue 1.5) (k1 + k2) |> EMP_summary() Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-08 01:29:19 "},"MD/7.5 物种数据导入 EMP_taxonomy_import.html":{"url":"MD/7.5 物种数据导入 EMP_taxonomy_import.html","title":"7.5 EMP_taxonomy_import","keywords":"","body":"7.5 物种数据导入 EMP_taxonomy_import 详细内容请参看: 2.1.3 读取微生物组学数据 Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 19:01:16 "},"MD/7.6 功能数据导入 EMP_function_import.html":{"url":"MD/7.6 功能数据导入 EMP_function_import.html","title":"7.6 EMP_function_import","keywords":"","body":"7.6 功能数据导入 EMP_function_import 详细内容请参看: 2.1.4 读取KO/EC组学数据 Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 19:01:13 "},"MD/7.7 标准数据导入 EMP_normal_import.html":{"url":"MD/7.7 标准数据导入 EMP_normal_import.html","title":"7.7 EMP_normal_import","keywords":"","body":"7.7 标准数据导入 EMP_normal_import 详细内容请参看: 2.1.5 读取标准表格信息 Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 19:01:10 "},"MD/7.8 快捷数据导入 EMP_easy_import.html":{"url":"MD/7.8 快捷数据导入 EMP_easy_import.html","title":"7.8 EMP_easy_import","keywords":"","body":"7.8 快捷数据导入 EMP_taxonomy_import 详细内容请参看：2.2 创建单一组学项目的MultiAssayExperiment对象 Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 19:01:05 "},"MD/8 data virtualization.html":{"url":"MD/8 data virtualization.html","title":"Chapter 8 Data Virtualization :","keywords":"","body":"8. 数据分析可视化 Data Virtualization : 欢迎阅读本章教程，本教程旨在为您提供全面的数据可视化技术指南。通过本教程，您将学习如何使用多种图表来分析和展示EasyMultiProfiler数据分析结果。无论是常见的基础图表和富集分析图表，还是生信数据分布和关系，本教程都将为您提供清晰的指导和实用的技巧，帮助您更有效地进行数据可视化。 Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-08 00:26:45 "},"MD/8.1 箱型图 EMP_boxplot.html":{"url":"MD/8.1 箱型图 EMP_boxplot.html","title":"8.1 EMP_boxplot","keywords":"","body":"8.1 箱型图 EMP_boxplot 箱形图又称为盒须图、盒式图、盒状图或箱线图，是一种用作显示一组数据分散情况资料的统计图。 8.1.1 针对丰度数据的箱型图 MAE |> EMP_assay_extract('host_gene',pattern = 'A1BG',pattern_ref = 'feature') |> EMP_boxplot(method='t.test',estimate_group='Group') 8.1.2 针对alpha多样性指数的箱型图 MAE |> EMP_assay_extract('taxonomy') |> EMP_alpha_analysis()|> EMP_boxplot(method='t.test',estimate_group='Group') Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-07 23:31:36 "},"MD/8.2 散点图 EMP_scatterplot.html":{"url":"MD/8.2 散点图 EMP_scatterplot.html","title":"8.2 EMP_scatterplot","keywords":"","body":"8.2 散点图 EMP_scatterplot 散点图是用笛卡尔坐标系上的点表示资料中二个或多个变量分布方式的图。 8.2.1 针对降维分析的可视化 注意show参数可以从三个维度观察降维结果并提供html交互式图形展示。 MAE |> EMP_assay_extract('taxonomy') |> EMP_identify_assay(method='default',estimate_group = 'Group') |> EMP_collapse(estimate_group = 'Genus',collapse_by = 'row') |> EMP_dimension_analysis(method = 'pcoa',distance='bray') |> EMP_scatterplot(estimate_group='Group',show='p12html',ellipse=0.3) Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-07 23:30:58 "},"MD/8.3 富集点状图 EMP_dotplot.html":{"url":"MD/8.3 富集点状图 EMP_dotplot.html","title":"8.3 EMP_dotplot","keywords":"","body":"8.3 富集点状图 EMP_dotplot 本模块用于对接GSEA分析后的富集气泡图。 8.3.1 KEGG富集分析的可视化 EMP_dotplot和EMP_netplot继承了enrichplot包的dotplot和cnetplot可以对富集分析的结果进行可视化。 MAE |> EMP_assay_extract(experiment = 'geno_ec') |> EMP_diff_analysis(method='DESeq2',.formula = ~Group) |> EMP_enrich_analysis(condition = pvalue EMP_dotplot() Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 19:48:13 "},"MD/8.4 富集网络图 EMP_netplot.html":{"url":"MD/8.4 富集网络图 EMP_netplot.html","title":"8.4 EMP_netplot","keywords":"","body":"8.4 富集网络图 EMP_netplot 本模块用于对接GSEA分析后的富集网络图。 8.4.1 KEGG富集分析的网络图 EMP_netplot继承了enrichplot包的dotplot和cnetplot可以对富集分析的结果进行可视化。 MAE |> EMP_assay_extract(experiment = 'geno_ec') |> EMP_diff_analysis(method='DESeq2',.formula = ~Group) |> EMP_enrich_analysis(condition = pvalue EMP_netplot() Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 19:48:21 "},"MD/8.5 双变量拟合图 EMP_fitline_plot.html":{"url":"MD/8.5 双变量拟合图 EMP_fitline_plot.html","title":"8.5 EMP_fitline_plot","keywords":"","body":"8.5 双变量拟合图 EMP_fitline_plot 本模块可以计算并绘制两变量的拟合线图。 8.5.1 单一组学内数据的双变量拟合 注意：1. show参数可以设置为html，用于展现交互式图形。2. estimate_group可以按照表型数据中的信息分别拟合。 3. formula参数可以调整拟合方程。 ## For EMPT MAE |> EMP_assay_extract('geno_ec') |> EMP_fitline_plot(var_select=c('1.1.1.1','BMI'),formula = y ~ poly(x, 1)) MAE |> EMP_assay_extract('geno_ec') |> EMP_fitline_plot(var_select=c('Weight','BMI'),estimate_group='Sex',show='pic') 8.5.2 多组学之间数据的双变量拟合 ## For EMP k1 EMP_assay_extract('geno_ec') |> EMP_decostand(method = 'clr') k2 EMP_assay_extract('taxonomy') |> EMP_collapse(collapse_by='row',estimate_group = 'Class',method = 'sum') |> EMP_decostand(method = 'relative') (k1 + k2) |> EMP_fitline_plot(var_select=c('1.1.1.1','Bacilli'), estimate_group='Group',eq_size=2.5) Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-08 01:16:25 "},"MD/8.6 富集曲线图 EMP_curveplot.html":{"url":"MD/8.6 富集曲线图 EMP_curveplot.html","title":"8.6 EMP_curveplot","keywords":"","body":"8.6 富集曲线图 EMP_curveplot 本模块用于对接GSEA分析后的富集曲线图。 MAE |> EMP_GSEA_analysis(experiment = 'geno_ko',method='signal2Noise', estimate_group = 'Group', pvalueCutoff = 0.05,keyType = 'ko') |> EMP_curveplot(geneSetID='map00680') Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-05 20:08:49 "},"MD/8.7 热图 EMP_heatmap_plot.html":{"url":"MD/8.7 热图 EMP_heatmap_plot.html","title":"8.7EMP_heatmap_plot","keywords":"","body":"8.7 热图 EMP_heatmap_plot 热图是一种用于可视化数据矩阵的图表，通过颜色来表示数值的大小。它在生物信息学、数据分析和统计学等领域广泛应用，能够直观地展示数据集的模式和关系。 8.3.1 数据丰度热图 例如展现EC酶组学差异分析后丰度结果。注意：1.在绘制热图前，可以根需要使用EMP_decostand进行标准化，让热图达到最佳的美化效果。这一点与pheatmap中的scale设计是一致的。2. 函数内palette 可以修改各种色板。 MAE |> EMP_assay_extract('geno_ec') |> EMP_diff_analysis(method='DESeq2',.formula = ~Group) |> EMP_filter(feature_condition = pvalue3.5) |> EMP_decostand(method = 'clr') |> EMP_heatmap_plot(clust_row=TRUE,clust_col=TRUE,rotate=TRUE) 8.3.2 相关性热图 本模块可以直接对接相关性分析的结果。详细内容请参考：6.3 相关性分析 EMP_cor_analysis micro_data EMP_assay_extract('taxonomy') |> EMP_identify_assay(method='default') |> EMP_collapse(estimate_group = 'Genus',collapse_by = 'row') |> EMP_decostand(method='relative') meta_data EMP_assay_extract('taxonomy') |> EMP_coldata_extract(action = 'add', coldata_to_assay = c('SAS','SDS','HAMA','HAMD','PHQ9','GAD7')) (micro_data + meta_data) |> EMP_cor_analysis() |> EMP_heatmap_plot(label_size=2,palette='Spectral', clust_row=TRUE,clust_col=TRUE) 8.3.3 WGCNA相关性热图 本模块可以直接对接WGCNA相关性分析的结果。详细内容请参考：6.10 EMP_WGCNA_cor_analysis MAE |> EMP_assay_extract('geno_ec') |> EMP_identify_assay(method = 'edgeR',estimate_group = 'Group') |> EMP_WGCNA_cluster_analysis(RsquaredCut = 0.85,mergeCutHeight=0.4) |> EMP_WGCNA_cor_analysis(coldata_to_assay = c('BMI','PHQ9','GAD7','HAMD','SAS','SDS'), method='spearman') |> EMP_heatmap_plot() Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-08 01:16:05 "},"MD/8.8 桑基图 EMP_sankey_plot.html":{"url":"MD/8.8 桑基图 EMP_sankey_plot.html","title":"8.8 EMP_sankey_plot","keywords":"","body":"8.8 桑基图 EMP_sankey_plot 桑基图((Sankey Diagram)，是一种特定类型的流图，通常用于描述多组特征之间的相互关系。 8.8.1 多重相关性桑基图 EMP_cor_analysis模块能够计算多个组学之间的相互关系。我们可以分别计算各个组学之间的差异特征，使用+将组学合并在一起，并按照组合顺序进行相关性检验。EMP_sankey_plot可以根据多重相关性结果，绘制相关性桑基图。注意：1. 相关性桑基图中，红色为正相关，蓝色为负相关。2. 相关性桑基图会评估每个节点之间的相互关系，孤立的节点将会被过滤。参数pvalue和rvalue可以调节边的数量。 micro_data EMP_assay_extract('taxonomy') |> EMP_identify_assay(method='default') |> EMP_collapse(estimate_group = 'Genus',collapse_by = 'row') |> EMP_decostand(method='relative') ko_data EMP_assay_extract('geno_ko') |> EMP_identify_assay(method='edgeR') |> EMP_diff_analysis(method='DESeq2',.formula = ~Region+Group) |> EMP_filter(feature_condition = pvalue EMP_assay_extract(experiment = 'untarget_metabol') |> EMP_collapse(estimate_group = 'MS2kegg',collapse_by='row', na_string = c(\"NA\", \"null\", \"\",\"-\"), method = 'mean',collapse_sep = '+') |> EMP_decostand(method = 'relative') |> EMP_dimension_analysis(method = 'pls',estimate_group = 'Group') |> EMP_filter(feature_condition = VIP >2) host_gene EMP_assay_extract('host_gene') |> EMP_identify_assay(method='edgeR') |> EMP_diff_analysis(method='DESeq2',.formula = ~Region+Group) |> EMP_filter(feature_condition = pvalue EMP_assay_extract('taxonomy') |> EMP_coldata_extract(action = 'add', coldata_to_assay = c('SAS','SDS','HAMA','HAMD','PHQ9','GAD7')) (micro_data + ko_data + metabolite_data + host_gene + meta_data) |> EMP_cor_analysis() |> EMP_sankey_plot() Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-08 01:14:47 "},"MD/8.9 结构柱状图 EMP_structure_plot.html":{"url":"MD/8.9 结构柱状图 EMP_structure_plot.html","title":"8.9 EMP_structure_plot","keywords":"","body":"8.9 结构柱状图 EMP_structure_plot 结构图主要用于展现数据内主要特征含量。例如在微生物组学数据中，可以展现丰度最高的前10名物种来展现样本内微生物的主要结构情况。 8.9.1 物种结构图 微生物数据经常需要绘制物种结构图。例如，绘制纲级别的物种丰度前10名的相对丰度结构图。注意：内置的色板最大上限只有15种，当需要绘制更多的Top特征，需要在函数内手动指定更多种类的色板palette。 MAE |> EMP_assay_extract('taxonomy') |> EMP_decostand(method = 'relative') |> EMP_collapse(estimate_group = 'Class',collapse_by = 'row') |> EMP_structure_plot(top_num=10) 可以利用estimate_group设置分组图。 MAE |> EMP_assay_extract('taxonomy') |> EMP_decostand(method = 'relative') |> EMP_collapse(estimate_group = 'Class',collapse_by = 'row') |> EMP_structure_plot(top_num=10,estimate_group='Group') 也可以提前将数据折叠成分组数据，在绘制分组的结构图。 MAE |> EMP_assay_extract('taxonomy') |> EMP_collapse(estimate_group = 'Sex',collapse_by = 'col') |> EMP_decostand(method = 'relative') |> EMP_collapse(estimate_group = 'Class',collapse_by = 'row') |> EMP_structure_plot(top_num=10) 8.9.2 差异基因前10名结构图 例如绘制差异基因中表达最高的前5名。 Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-08 01:14:05 "},"MD/8.10 火山图 EMP_volcanol_plot.html":{"url":"MD/8.10 火山图 EMP_volcanol_plot.html","title":"8.10 EMP_volcanol_plot","keywords":"","body":"8.10 火山图 EMP_volcanol_plot 本模块可以绘制差异分析后的特征火山图。 8.10.1 简单输出火山图 注意：show参数可以设置为html输出可交互是图形。 MAE |> EMP_decostand(experiment = 'geno_ec',method = 'integer') |> EMP_diff_analysis(method='DESeq2',.formula = ~Group) |> EMP_volcanol_plot(show='html') 8.10.2 标注特征的火山图 注意：本函数继承了ggrepel::geom_text_repel的参数用法，可以标注感兴趣的特征。 MAE |> EMP_decostand(experiment = 'geno_ec',method = 'integer') |> EMP_diff_analysis(method='DESeq2',.formula = ~Group) |> EMP_volcanol_plot(key_feature = c('3.6.1.62','1.5.3.19'),show='pic', min.segment.length = 0, seed = 42, box.padding = 0.5) MAE |> EMP_decostand(experiment = 'geno_ec',method = 'integer') |> EMP_diff_analysis(method='DESeq2',.formula = ~Group) |> EMP_volcanol_plot(key_feature = c('3.6.1.62','1.5.3.19'),color = \"white\", bg.color = \"grey30\",bg.r = 0.15) Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-08 01:11:30 "},"MD/Contact.html":{"url":"MD/Contact.html","title":"Contact","keywords":"","body":"联系我们 😃😃😃非常感谢您使用EasyMultiProfiler工具进行微生物分析，欢迎加入QQ群进行相关的讨论。 QQ讨论群: 729506293🔥🔥🔥 📬📬📬如果到任何BUG或者建议，欢迎随时联系我们。 E-Mail: 382983280@qq.com✉️ E-Mail:xielw@gdim.cn ✉️ 👇👇👇如果我们工具有帮助到您的文章发表，非常感谢您能引用我们的文章。 Copyright © 382983280@qq.com 2024 all right reserved，powered by Gitbook更新时间： 2024-07-06 01:21:39 "}}