### 9 更多有用函数

本章节包含诸多快捷的函数方便配合`EasyMultiProfiler`数据分析流程使用

#### 9.1 快速的相关性分析CorRcpp

在`EasyMultiProfiler`函数内部使用了C++语言极大的加速了相关性分析的计算。

```R
data_df1 <- data.frame(
  A = c(11, 23, 3, 45, 5),
  B = c(62, 7, 82, 9, 10),
  C = c(11, 54, 13, 42, 15),
  D = c(16, 42, 18, 23, 20),
  E = c(12, 54, 23, 33, 42)
)

data_df2 <- data.frame(
  Tom = c(11, 27, 23, 29, 30),
  Anny = c(31, 16, 33, 98, 35),
  Jerry = c(36, 37, 45, 39, 40),
  Cat = c(41, 21, 43, 44, 45),
  White = c(46, 77, 48, 94, 12)
)
re <- CorRcpp(data_df1,data_df2,type = 'spearman')
re$R_matrix # correlation value
re$P_matrix # pvalue
```

#### 9.2 多重字符串匹配检测 str_detect_multi

此函数可以同时匹配多个感兴趣的字符串。

```R
text <- c('Bacilli_unclassfiled','Bacteroidia_uncuture','Other')
str_detect_multi(text,c('Bacilli','bacteroidia'),exact=FALSE) # Ignore the capital letter
str_detect_multi(text,c('Bacilli','Bacteroidia'),exact=TRUE) # Set the matched completely
```

在`EasyMultiProfiler`数据分析流程也可以提供帮助。

例如，可以同时提取微生物组学中门级别中Bacteroidetes和Firmicutes的物种。

```R
MAE |> 
  EMP_assay_extract('taxonomy') %>%
  EMP_filter(feature_condition = str_detect_multi(Phylum,c('Bacteroidetes','Firmicutes')))
```

例如，可以剔除在纲级别没有完整注释的物种

```R
MAE |> 
  EMP_assay_extract('taxonomy') %>%
  EMP_filter(feature_condition = !str_detect_multi(Class,'unclassified'))
```





